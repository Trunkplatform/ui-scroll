/*!
 * angular-ui-scroll
 * https://github.com/angular-ui/ui-scroll.git
 * Version: 1.3.2 -- 2015-11-25T00:45:50.813Z
 * License: MIT
 */
!function(){"use strict";angular.module("ui.scroll",[]).directive("uiScrollViewport",function(){return{controller:["$scope","$element",function(a,b){return this.viewport=b,this}]}}).directive("uiScroll",["$log","$injector","$rootScope","$timeout","$q","$parse",function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p;return n=a.debug||a.log,k=function(a,b){return b.after(a),[]},o=function(a){return a.element.remove(),a.scope.$destroy(),[]},b.has&&b.has("$animate")&&(g=b.get("$animate")),m=1===angular.version.major&&angular.version.minor<3,g?m?(l=function(a,b){var c;return c=e.defer(),g.enter(a,null,b,function(){return c.resolve()}),[c.promise]},p=function(a){var b;return b=e.defer(),g.leave(a.element,function(){return a.scope.$destroy(),b.resolve()}),[b.promise]}):(l=function(a,b){return[g.enter(a,null,b)]},p=function(a){return[g.leave(a.element).then(function(){return a.scope.$destroy()})]}):(l=k,p=o),h=function(a,b,c){var d;return d=Object.create(Array.prototype),d.insert=function(e,f){var g,h;if(g=b.$new(),g[a]=f,h={scope:g},c(g,function(a){return h.element=a}),e%1===0)return h.op="insert",d.splice(e,0,h);switch(h.op=e,e){case"append":return d.push(h);case"prepend":return d.unshift(h)}},d.remove=function(a,b){var c,e,f,g;if(angular.isNumber(a)){for(c=e=f=a,g=b;g>=f?g>e:e>g;c=g>=f?++e:--e)o(d[c]);return d.splice(a,b-a)}return d.splice(d.indexOf(a),1),p(a)},d.clear=function(){return d.remove(0,d.length)},d},i=function(a){var b,c,d,e;if(e=a.localName,"dl"===e)throw new Error("ui-scroll directive does not support <"+e+"> as a repeating tag: "+a.outerHTML);switch("li"!==e&&"tr"!==e&&(e="div"),e){case"tr":d=angular.element("<table><tr><td><div></div></td></tr></table>"),b=d.find("div"),c=d.find("tr");break;default:c=angular.element("<"+e+"></"+e+">")}return c},j=function(a,b){var c,d,e;return e=b[0]&&b[0].viewport?b[0].viewport:angular.element(window),e.css({"overflow-y":"auto",display:"block"}),d=null,c=null,e.createPaddingElements=function(b){return d=new i(b),a.before(d),e.topPadding=function(){return d.height.apply(d,arguments)},c=new i(b),a.after(c),e.bottomPadding=function(){return c.height.apply(c,arguments)}},e.bottomDataPos=function(){var a;return(null!=(a=e[0].scrollHeight)?a:e[0].document.documentElement.scrollHeight)-c.height()},e.topDataPos=function(){return d.height()},e.bottomVisiblePos=function(){return e.scrollTop()+e.outerHeight()},e.topVisiblePos=function(){return e.scrollTop()},e.insertElement=function(a,b){return k(a,b||d)},e.insertElementAnimated=function(a,b){return l(a,b||d)},e},{require:["?^uiScrollViewport"],transclude:"element",priority:1e3,terminal:!0,compile:function(a,g,i){var k,l,m;if(!(m=g.uiScroll.match(/^\s*(\w+)\s+in\s+([\w\.]+)\s*$/)))throw new Error("Expected uiScroll in form of '_item_ in _datasource_' but got '"+g.uiScroll+"'");return l=m[1],k=m[2],function(a,g,m,n,o){var p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$;if(o=o||i,C=f(k)(a),K=function(){return angular.isObject(C)&&angular.isFunction(C.get)},!K()&&(C=b.get(k),!K()))throw new Error(k+" is not a valid datasource");return x=Math.max(3,+m.bufferSize||10),w=function(){return X.outerHeight()*Math.max(.1,+m.padding||.1)},y=null,S=0,I=1,N=1,v=new h(l,a,o),O=[],F=!1,u=!1,X=new j(g,n),o(a.$new(),function(b,c){return X.createPaddingElements(b[0]),c.$destroy(),a.$on("$destroy",function(){return b.remove()})}),Y=X.scope()||c,V=function(a){return p.topVisible=a.scope[l],p.topVisibleElement=a.element,p.topVisibleScope=a.scope,m.topVisible&&f(m.topVisible).assign(Y,p.topVisible),m.topVisibleElement&&f(m.topVisibleElement).assign(Y,p.topVisibleElement),m.topVisibleScope&&f(m.topVisibleScope).assign(Y,p.topVisibleScope),angular.isFunction(C.topVisible)?C.topVisible(a):void 0},M=function(b){return p.isLoading=b,m.isLoading&&f(m.isLoading).assign(a,b),angular.isFunction(C.loading)?C.loading(b):void 0},D=function(){return S++,O=[]},Q=function(){return D(),I=1,N=1,v.clear(),X.topPadding(0),X.bottomPadding(0),F=!1,u=!1,r(S)},T=function(){return!F&&X.bottomDataPos()<X.bottomVisiblePos()+w()},A=function(){var a,b,c,d,e,f,g,h,i,j;for(a=0,h=0,b=f=i=v.length-1;0>=i?0>=f:f>=0;b=0>=i?++f:--f)if(c=v[b],e=c.element.offset().top,g=j!==e,j=e,g&&(d=c.element.outerHeight(!0)),X.bottomDataPos()-a-d>X.bottomVisiblePos()+w())g&&(a+=d),h++,F=!1;else{if(g)break;h++}return h>0?(X.bottomPadding(X.bottomPadding()+a),v.remove(v.length-h,v.length),N-=h):void 0},U=function(){return!u&&X.topDataPos()>X.topVisiblePos()-w()},B=function(){var a,b,c,d,e,f,g,h,i;for(i=0,g=0,d=0,e=v.length;e>d;d++)if(a=v[d],c=a.element.offset().top,f=h!==c,h=c,f&&(b=a.element.outerHeight(!0)),X.topDataPos()+i+b<X.topVisiblePos()-w())f&&(i+=b),g++,u=!1;else{if(f)break;g++}return g>0?(X.topPadding(X.topPadding()+i),v.remove(0,g),I+=g):void 0},E=function(a,b){return p.isLoading||M(!0),1===O.push(b)?H(a):void 0},L=function(a){return a.element.height()&&a.element[0].offsetParent},Z=function(a){var b,c,d;if(L(a)){for(c=0,d=v.length;d>c;c++)b=v[c],angular.isFunction(b.unregisterVisibilityWatcher)&&(b.unregisterVisibilityWatcher(),delete b.unregisterVisibilityWatcher);return r()}},J=function(a,b){return X.insertElement(a.element,b),L(a)?!0:(a.unregisterVisibilityWatcher=a.scope.$watch(function(){return Z(a)}),!1)},P=function(a){var b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,s,t;for(p=[],q=[],s=[],b=X.bottomDataPos(),d=g=0,k=v.length;k>g;d=++g)switch(t=v[d],t.op){case"prepend":q.unshift(t);break;case"append":i=0===d?J(t)||i:J(t,v[d-1].element)||i,t.op="none";break;case"insert":p=0===d?p.concat(X.insertElementAnimated(t.element)):p.concat(X.insertElementAnimated(t.element,v[d-1].element)),t.op="none";break;case"remove":s.push(t)}for(h=0,l=s.length;l>h;h++)t=s[h],p=p.concat(v.remove(t));if(X.bottomPadding(Math.max(0,X.bottomPadding()-(X.bottomDataPos()-b))),q.length){for(b=X.bottomDataPos(),j=0,m=q.length;m>j;j++)t=q[j],i=J(t)||i,t.op="none";c=X.bottomDataPos()-b,X.topPadding()>=c?X.topPadding(X.topPadding()-c):X.scrollTop(X.scrollTop()+c)}for(d=o=0,n=v.length;n>o;d=++o)f=v[d],f.scope.$index=I+d;return p.length&&e.all(p).then(function(){return r(a)}),i},z=function(){var a,b,c,d,e,f,g,h,i;for(i=0,g=[],d=0,e=v.length;e>d;d++){if(a=v[d],c=a.element.offset().top,f=h!==c,h=c,f&&(b=a.element.outerHeight(!0)),!(f&&X.topDataPos()+i+b<X.topVisiblePos())){f&&V(a);break}g.push(i+=b)}return g},r=function(a){return d(function(){return P(a),T()?E(a,!0):U()&&E(a,!1),0===O.length?z():void 0})},s=function(a){return d(function(){var b;return b=P(a),T()?b&&E(a,!0):U()&&(b||O[0])&&E(a,!1),O.shift(),0===O.length?(M(!1),z()):H(a)})},H=function(b){return O[0]?v.length&&!T()?s(b):C.get(N,x,function(c,d){var e,f,g,h;if(!(b&&b!==S||a.$$destroyed)){if(e=null!=d?d:c.length<x,e&&(F=!0,X.bottomPadding(0)),c.length>0)for(B(),g=0,h=c.length;h>g;g++)f=c[g],++N,v.insert("append",f);return s(b)}}):v.length&&!U()?s(b):C.get(I-x,x,function(c,d){var e,f,g,h;if(!(b&&b!==S||a.$$destroyed)){if(e=null!=d?d:c.length<x,e&&(u=!0,X.topPadding(0)),c.length>0)for(v.length&&A(),f=g=h=c.length-1;0>=h?0>=g:g>=0;f=0>=h?++g:--g)--I,v.insert("prepend",c[f]);return s(b)}})},R=function(){return c.$$phase||p.isLoading?void 0:(r(),a.$apply())},$=function(a){var b,c;return b=X[0].scrollTop,c=X[0].scrollHeight-X[0].clientHeight,0===b&&!u||b===c&&!F?a.preventDefault():void 0},X.bind("resize",R),X.bind("scroll",R),X.bind("mousewheel",$),a.$watch(C.revision,Q),a.$on("$destroy",function(){return v.clear(),X.unbind("resize",R),X.unbind("scroll",R),X.unbind("mousewheel",$)}),p={},p.isLoading=!1,p.reload=Q,t=function(a,b){var c,d,e,f,g,h,i;if(angular.isArray(b)){for(h=v.indexOf(a)+1,i=b.reverse(),c=d=0,f=i.length;f>d;c=++d)g=i[c],g===a.scope[l]?(e=!0,h--):v.insert(h,g);if(!e)return a.op="remove"}},p.applyUpdates=function(a,b){var c,d,e,f,g,h;if(D(),angular.isFunction(a))for(c=v.slice(0),d=e=0,f=c.length;f>e;d=++e)h=c[d],t(h,a(h.scope[l],h.scope,h.element));else{if(a%1!==0)throw new Error("applyUpdates - "+a+" is not a valid index");0<=(g=a-I)&&g<v.length&&t(v[a-I],b)}return r(S)},p.append=function(a){var b,c,d;for(D(),c=0,d=a.length;d>c;c++)b=a[c],++N,v.insert("append",b);return r(S)},p.prepend=function(a){var b,c,d,e;for(D(),e=a.reverse(),c=0,d=e.length;d>c;c++)b=e[c],--I,v.insert("prepend",b);return r(S)},m.adapter&&(q=f(m.adapter)(a),angular.isObject(q)||(f(m.adapter).assign(a,{}),q=f(m.adapter)(a)),angular.extend(q,p),p=q),W=function(a){throw new Error(a+" event is no longer supported - use applyUpdates instead")},G=C.scope?C.scope.$new():a.$new(),G.$on("insert.item",function(){return W("insert")}),G.$on("update.items",function(){return W("update")}),G.$on("delete.items",function(){return W("delete")})}}}}])}();